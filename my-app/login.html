<html>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<head>

</head>
<body>

<div id="mainDiv">
<div id="signInDiv">
Name: <input id="name" type="text" name="name" value=""/><br>
Password: <input id="password" type="text" name="password" value=""/><br>
<input id="submit" type="button" value="Submit"/>
<div id="tryAgain"></div>
</div>
<table id="posts">
</table>
</div>



<script>
var testObj = {title: "trial post 1", message:"I just want to see how this is formatted as a json object.",author: "Tyler", time:"3-12-16 3:05pm"};
var testObj2 = {"title":"another post","message":"s'more text to see how this works.","author":"Drake","time":"3-12-16 3:14pm"};
var myConvertedObject = JSON.stringify([testObj,testObj2]);
console.log(myConvertedObject);

$(document).ready(function() {
	$("#submit").click(checkLogin);
	
});

checkLogin = function() {
	$.post("checkLogin.php", {name : $("#name").val(), password : $("#password").val()}, 
		function(data,status) { 
			if (data == "success") {
				viewPosts();
			}
			else {
				$("#tryAgain").html('<p style="color:red;">Wrong. Try Again</p>');
			}
		}
	);
}
viewPosts = function(){
	//replace my div with html to display posts
	$.post("viewPosts.php",$.post("viewPosts.php",function(data,status){
		var posts = JSON.parse(data);
		//posts is an array of objects, each of which has a title, message, author, and time string
		//get info like this: posts[0].message
		//TODO: make some html structure with a table to display the posts
		$("#signInDiv").empty();
		
		$("#posts").append("<tr><td>"+
							posts[0].title+"<br>"+
							posts[0].author+"<br>"+
							posts[0].time+"<br>"+
							posts[0].message+"<br>"+
							"<input id='button' type='button' value='Update'/><br><br></td></tr>");
		$("#posts").append("<tr><td>"+
							posts[1].title+"<br>"+
							posts[1].author+"<br>"+
							posts[1].time+"<br>"+
							posts[1].message+"<br>"+
							"<input id='button' type='button' value='Update'/><br><br></td></tr>");	
	});
}
</script>
<script>
function makeEditDialogue(postJson){
	var post = JSON.parse(postJson);
	var newMsg = prompt("Edit post: " + post.title + "\n" +
	"Original post by " + post.author + " at " + post.time,
	post.message);
	post.message = newMsg;
	return post;
}
//makeEditDialogue(JSON.stringify(posts[0]));
function editPost(postJson){
	var post = makeEditDialogue(postJson);
	//send a json of the updated post to server with updatePosts.php
	$.post("updatePosts.php",post,function(data,status){
		
	});
}
</script>
</body>
</html>